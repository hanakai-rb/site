<%= content_for :title, "#{guide.title} / #{page.title} &middot; #{org_name(org)} #{version} Guides" %>

<%= content_for :meta do %>
  <meta
    name="docsearch:version"
    content="<%= [version_number, ("latest" if version == latest_version)].compact.join(",") %>"
  >
<% end %>

<div class="lg:grid lg:grid-cols-16 lg:gap-8 md:grid md:grid-cols-5 md:gap-8">
  <aside class="lg:col-span-3">
    <div
      class="
        lg:sticky
        lg:pt-8 lg:top-[calc(var(--hk-nav-height))]
        lg:max-h-[calc(100vh-var(--hk-nav-height)-(var(--spacing)*8))]
        flex flex-col
      "
    >
      <div
        class="
          lg:overflow-y-auto flex-1 pr-4 scrolling-panel
          scrolling-panel--with-bottom-overlay
        "
        data-defo-ensure-active-nav-link-visible
      >
        <div class="sticky top-0">
          <div
            class="bg-white flex gap-2 pb-2 items-center"
            data-testid="org-guide-versions"
          >
            <%= render "svgs/#{org}_logo", width: 24, height: 24 %>
            <%= render "doc_pages/version_select",
                      id: "org-guide-versions",
                      version: version,
                      other_versions: other_versions,
                      path_prefix: "/guides/#{org}" %>
          </div>
          <div
            class="
              bg-gradient-to-b from-white to-transparent h-4
              pointer-events-none
            "
          ></div>
        </div>

        <nav>
          <ol data-testid="guides-list">
            <% org_guides.each do |guide_for_nav| %>
              <li class="mb-6">
                <div
                  class="
                    font-mono uppercase text-xs font-semibold text-primary
                    tracking-wide mb-2
                  "
                >
                  <%= guide_for_nav.title %>
                </div>
                <%= render "doc_pages/pages_nav", pages: guide_for_nav.pages.nested, testid: "pages-nav", current_page_url:
            page.url_path %>
              </li>
            <% end %>
          </ol>
        </nav>
      </div>
    </div>
  </aside>

  <section class="lg:col-span-13 lg:grid lg:grid-cols-13 md:col-span-4">
    <aside class="lg:col-span-3 lg:order-2">
      <div
        class="
          lg:pt-8 lg:sticky lg:top-[calc(var(--hk-nav-height))]
          lg:max-h-[calc(100vh-var(--hk-nav-height)-(var(--spacing)*8))]
          relative
          flex flex-col
        "
      >
        <div class="absolute top-8 bottom-0 right-full w-9 overflow-hidden">
          <div
            class="
              toc-indicator lg:block top-0 absolute right-[calc(100%)+var(--spacing)*4)]
              hidden transition-transform duration-500
              ease-in-out scale-0
            "
          >
            <%= render "svgs/#{org}_logo", width: 20, height: 20 %>
          </div>
        </div>
        <div
          id="toc-scrolling-panel"
          class="flex-1 overflow-y-auto over scrolling-panel scrolling-panel--with-bottom-overlay"
        >
          <h2 class="font-mono text-xs tracking-wider uppercase text-primary pt-1 mb-3">
            On this page
          </h2>

          <nav data-defo-toc-scroll="<%= { anchorContainerSelector: ".content", "scrollReferenceSelector": "#toc-scrolling-panel", breakpoints: ["lg"] }.to_json %>">
            <%= render "doc_pages/headings_toc", headings: page.nested_headings, testid: "headings-toc", depth: 0 %>
          </nav>
        </div>
      </div>
    </aside>
    <div class="lg:col-span-10 lg:pr-8 lg:mt-8 lg:mb-14">
      <header class="pt-1 mb-3">
        <h1 class="font-mono text-xs text-primary tracking-wider uppercase">
          <a href="<%= guide.url_path %>"><%= guide.title %></a>
        </h1>
      </header>

      <header>
        <h1 class="text-4xl font-black mb-4"><%= page.title %></h1>
      </header>

      <div class="content search-content"><%= page.content_html %></div>
    </div>
  </section>
</div>
