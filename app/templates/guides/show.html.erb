<%= content_for :title, "#{guide.title} / #{page.title} &middot; #{org_name(org)} #{version} Guides" %>

<%= render_with_slots "doc_pages/main" do |main| %>
  <%# Navigation %>
  <%= main.slot :navigation do %>
    <%= render_with_slots "doc_pages/navigation_desktop", org:, version:, other_versions:, path_prefix: "/guides/#{org}" do |navigation_desktop| %>
      <%= navigation_desktop.slot :nav do %>
        <ol data-testid="guides-list">
          <% org_guides.each do |guide_for_nav| %>
            <li class="mb-6">
              <div
                class="
                  font-mono uppercase text-xs font-semibold text-primary
                  tracking-wide mb-2
                "
              >
                <%= guide_for_nav.title %>
              </div>
              <%= render "doc_pages/pages_nav", pages: guide_for_nav.pages.nested, depth: 0, testid: 'pages-nav', current_page_url: page.url_path %>
            </li>
          <% end %>
        </ol>
      <% end %>
    <% end %>

    <%= render_with_slots "doc_pages/navigation_mobile" do |navigation_mobile| %>
      <%= navigation_mobile.slot :nav do %>
        <div class="flex">
          <div class="flex gap-2 order-2 sticky top-3 self-start items-center">
            <%= render "doc_pages/version_select",
                        id: "version-select",
                        version: version,
                        other_versions: other_versions,
                        path_prefix: "/guides/#{org}",
                        anchor: "right" %>
            <%= render "svgs/#{org}_logo", width: 28, height: 28 %>
          </div>
          <ol class="order-1 flex-1 mt-1.5" data-testid="guides-list">
            <% org_guides.each do |guide_for_nav| %>
              <li class="mb-6">
                <div
                  class="
                    font-mono uppercase text-xs font-semibold text-primary
                    tracking-wide mb-2
                  "
                >
                  <%= guide_for_nav.title %>
                </div>
                <%= render "doc_pages/pages_nav", pages: guide_for_nav.pages.nested, depth: 0, testid: 'pages-nav', current_page_url: page.url_path %>
              </li>
            <% end %>
          </ol>
        </div>
      <% end %>

      <% if page.nested_headings.length > 0 %>
        <%= navigation_mobile.slot :toc do %>
          <%= render "doc_pages/toc_desktop_headings", headings: page.nested_headings, testid: "headings-toc", depth: 0 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <%# Table of contents %>
  <%= main.slot :toc do %>
    <%= render "doc_pages/toc_desktop", org: org, headings: page.nested_headings %>
  <% end %>

  <%# Content %>
  <%= main.slot :content do %>
    <%= render "doc_pages/breadcrumbs", breadcrumbs:, org: %>

    <header>
      <h1 class="text-4xl font-black mb-4"><%= page.title %></h1>
    </header>

    <div class="content"><%= page.content_html %></div>
  <% end %>
<% end %>
